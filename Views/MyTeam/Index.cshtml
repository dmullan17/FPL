@using Newtonsoft.Json;

@model FPL.ViewModels.FPL.MyTeamViewModel

@{ var data = JsonConvert.SerializeObject(Model); }

@section PageScripts {
    <script src="~/js/myteam/index.js"></script>
    <script type="text/javascript">
    const viewModel = new MyTeamViewModel(@Html.Raw(data));
    ko.applyBindings(viewModel, document.getElementById("app"));
    </script>
}

<div id="app">
    <div class="ui container">
        <h3 class="ui header" data-bind="with: $root.Team()">
            <span data-bind="text: name"></span>
        </h3>
        <h4 class="ui header">
            Total Points: <span data-bind="text: $root.TotalPoints()"></span>
        </h4>
        <h4 class="ui header">
            Team Value: <span data-bind="text: $root.TotalPoints()"></span>
        </h4>
        <table class="ui table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Team</th>
                    <th>Position</th>
                    <th>Value</th>
                    <th>Points</th>
                    <th>Points while on Team</th>
                    <th>PPG</th>
                    <th>Overall ICT Ranking</th>
                    <th>Position ICT Ranking</th>
                    <th>% Selected by</th>
                    <th>Next Game</th>
                    @*<th>Form</th>
        <th>Points achieved</th>
        <th>Next Game</th>*@
                </tr>
            </thead>
            <tbody data-bind="foreach: $root.Picks">
                <tr>
                    <td>
                        <span data-bind="text: player.web_name"></span>
                        <span data-bind="visible: is_captain"><i class="copyright icon"></i></span>
                        <span data-bind="visible: player.in_dreamteam"><i class="star icon"></i></span>
                    </td>
                    <td>
                        <span data-bind="text: player.Team.short_name"></span>
                    </td>
                    <td>
                        <span data-bind="text: $root.GetPosition(player.element_type)"></span>
                    </td>
                    <td>
                        <span data-bind="text: $root.FormatValue(player.now_cost)"></span>
                    </td>
                    <td>
                        <span data-bind="text: player.total_points"></span>
                    </td>
                    <td>
                        <span data-bind="text: TotalPointsAccumulatedForTeam"></span>
                    </td>
                    <td>
                        <span data-bind="text: player.points_per_game"></span>
                    </td>
                    <td>
                        <span data-bind="text: $root.FormatOverallRank(player.ict_index_rank)"></span>
                    </td>
                    <td>
                        <span data-bind="text: $root.FormatPositionRankType(player.element_type, player.ict_index_rank_type)"></span>
                    </td>
                    <td>
                        <span data-bind="text: player.selected_by_percent"></span>
                    </td>
                    <td>
                        <span data-bind="text: $root.GetPlayersNextFixture(player.Team)"></span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>